import{_ as U,m as q,p as _,q as y,s as I,u as C,r as u,o as n,c as d,b as a,a as e,F as V,h as L,i as m,t as r,g as f,v as b,w as F,d as k,n as p}from"./index-Bm-XFVvy.js";import{p as w}from"./productStore-DvqAJerG.js";q("isPhone",t=>/^(09)[0-9]{8}$/.test(t)?!0:"需要正確的電話號碼");const N={data(){return{product:{},coupon_code:""}},computed:{..._(w,["sortProducts"]),..._(y,["cart","form"]),..._(I,["isLoading","loadingItem"])},methods:{...C(w,["getProducts"]),...C(y,["addToCart","getCart","updateCart","removeCartItem","addCouponCode","createOrder"]),getProduct(t){this.$router.push(`/user/product/${t}`)},addCouponCode(){const t="https://ec-course-api.hexschool.io/api/kk0414/coupon",o={code:this.coupon_code};this.isLoading=!0,this.$http.post(t,{data:o}).then(g=>{this.$httpMessageState(g,"加入優惠券"),this.getCart(),this.isLoading=!1})},onSubmitOrder(){this.createOrder(this.$router)}},created(){this.getProducts(),this.getCart()}},P={class:"container"},E={class:"row mt-4"},M={class:"col-md-6"},O={class:"sticky-top"},B={class:"table align-middle"},T=e("thead",null,[e("tr",null,[e("th"),e("th",null,"圖片"),e("th",null,"品名"),e("th",{style:{width:"110px"}},"數量"),e("th",{class:"text-end"},"單價")])],-1),j=["disabled","onClick"],D=e("i",{class:"bi bi-x"},null,-1),x=[D],z={style:{width:"200px"}},A=["src"],R={key:0,class:"text-success"},G={class:"input-group input-group-sm"},H=e("label",{for:"quantityInput"},null,-1),J=["disabled","onChange","onUpdate:modelValue"],K={class:"input-group-text"},Q={class:"text-end"},W={key:0,class:"text-success"},X=e("td",{colspan:"4",class:"text-end"},"總計",-1),Y={class:"text-end"},Z={key:0},ee=e("td",{colspan:"4",class:"text-end text-success"},"折扣價",-1),te={class:"text-end text-success"},se={class:"input-group mb-3 input-group-sm d-flex align-items-end justify-content-end"},oe={for:"couponInput"},le={class:"input-group-append"},ae={class:"col-md-6"},ne={class:"row justify-content-end mt-2"},de={class:"mb-3"},re=e("label",{for:"email",class:"form-label"},"Email",-1),ie={class:"mb-3"},ce=e("label",{for:"name",class:"form-label"},"收件人姓名",-1),ue={class:"mb-3"},me=e("label",{for:"tel",class:"form-label"},"收件人電話",-1),pe={class:"mb-3"},he=e("label",{for:"address",class:"form-label"},"收件人地址",-1),_e={class:"mb-3"},fe=e("label",{for:"message",class:"form-label"},"留言",-1),be=e("div",{class:"text-end"},[e("button",{class:"btn btn-danger"},"送出訂單")],-1),ge=e("div",{class:"my-5 row"},null,-1);function ve(t,o,g,ye,v,h){const $=u("LoadingView"),i=u("FieldView"),c=u("ErrorMessage"),S=u("FormView");return n(),d(V,null,[a($,{active:t.isLoading},null,8,["active"]),e("div",P,[e("div",E,[e("div",M,[e("div",O,[e("table",B,[T,e("tbody",null,[t.cart.carts?(n(!0),d(V,{key:0},L(t.cart.carts,s=>(n(),d("tr",{key:s.id},[e("td",null,[e("button",{type:"button",class:"btn btn-outline-danger btn-sm",disabled:t.loadingItem===s.id,onClick:l=>t.removeCartItem(s.id)},x,8,j)]),e("td",z,[e("img",{src:s.product.imageUrl,alt:""},null,8,A)]),e("td",null,[k(r(s.product.title)+" ",1),s.coupon?(n(),d("div",R,"已套用優惠券")):m("",!0)]),e("td",null,[e("div",G,[H,f(e("input",{type:"number",id:"quantityInput",class:"form-control col-auto",min:"1",disabled:s.id===t.loadingItem,onChange:l=>t.updateCart(s),"onUpdate:modelValue":l=>s.qty=l},null,40,J),[[b,s.qty,void 0,{number:!0}]]),e("div",K,"/ "+r(s.product.unit),1)])]),e("td",Q,[t.cart.final_total!==t.cart.total?(n(),d("small",W,"折扣價：")):m("",!0),k(" "+r(t.$filters.currency(s.final_total)),1)])]))),128)):m("",!0)]),e("tfoot",null,[e("tr",null,[X,e("td",Y,r(t.$filters.currency(t.cart.total)),1)]),t.cart.final_total!==t.cart.total?(n(),d("tr",Z,[ee,e("td",te,r(t.$filters.currency(t.cart.final_total)),1)])):m("",!0)])]),e("div",se,[e("label",oe,[f(e("input",{type:"text",id:"couponInput",class:"form-control","onUpdate:modelValue":o[0]||(o[0]=s=>v.coupon_code=s),placeholder:"請輸入優惠碼"},null,512),[[b,v.coupon_code]])]),e("div",le,[e("button",{class:"btn btn-outline-secondary",type:"button",onClick:o[1]||(o[1]=(...s)=>h.addCouponCode&&h.addCouponCode(...s))}," 套用優惠碼 ")])])])]),e("div",ae,[e("div",ne,[a(S,{class:"col-md-10",onSubmit:h.onSubmitOrder},{default:F(({errors:s})=>[e("div",de,[re,a(i,{id:"email",name:"email",type:"email",class:p(["form-control",{"is-invalid":s.email}]),placeholder:"請輸入 Email",rules:"email|required",modelValue:t.form.user.email,"onUpdate:modelValue":o[2]||(o[2]=l=>t.form.user.email=l)},null,8,["class","modelValue"]),a(c,{name:"email",class:"invalid-feedback"})]),e("div",ie,[ce,a(i,{id:"name",name:"姓名",type:"text",class:p(["form-control",{"is-invalid":s.姓名}]),placeholder:"請輸入姓名",rules:"required",modelValue:t.form.user.name,"onUpdate:modelValue":o[3]||(o[3]=l=>t.form.user.name=l)},null,8,["class","modelValue"]),a(c,{name:"姓名",class:"invalid-feedback"})]),e("div",ue,[me,a(i,{id:"tel",name:"電話",type:"tel",class:p(["form-control",{"is-invalid":s.電話}]),placeholder:"請輸入電話",rules:"required|isPhone",modelValue:t.form.user.tel,"onUpdate:modelValue":o[4]||(o[4]=l=>t.form.user.tel=l)},null,8,["class","modelValue"]),a(c,{name:"電話",class:"invalid-feedback"})]),e("div",pe,[he,a(i,{id:"address",name:"地址",type:"text",class:p(["form-control",{"is-invalid":s.地址}]),placeholder:"請輸入地址",rules:"required",modelValue:t.form.user.address,"onUpdate:modelValue":o[5]||(o[5]=l=>t.form.user.address=l)},null,8,["class","modelValue"]),a(c,{name:"地址",class:"invalid-feedback"})]),e("div",_e,[fe,f(e("textarea",{name:"",id:"message",class:"form-control",cols:"30",rows:"10","onUpdate:modelValue":o[6]||(o[6]=l=>t.form.message=l)},null,512),[[b,t.form.message]])]),be]),_:1},8,["onSubmit"])])])]),ge])],64)}const ke=U(N,[["render",ve]]);export{ke as default};
